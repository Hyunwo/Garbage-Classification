<?php
    include 'list.php';

?>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>자유게시판</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <style>
        .us-cursor { cursor: pointer;}
    </style>
</head>
<body>
    <div class="container mt-3">
        <h1 class="h1">자유게시판</h1>
    </div>
    <div class="container mt-3">
        <table class="table table-bordered table-hover">
            <colgroup>
                <col width="7%">
                <col width="63%">
                <col width="10%">
                <col width="10%">
                <col width="10%">
            </colgroup>
            <thead class="text-bg-primary text-center">
            <tr>
                <th>번호</th>
                <th>제목</th>
                <th>글쓴이</th>
                <th>등록일</th>
                <th>조회수</th>
            </tr>
           </thead>
            <?php
            foreach($rs AS $row) {
            ?>
            <tr class="view_detail us-cursor" data-idx="<?= $row['idx']; ?>" data-code="<?= $code; ?>">
                <td class="text-center"><?= $row['idx']; ?></td>
                <td><?= $row['subject']; ?></td>
                <td class="text-center"><?= $row['name']; ?></td>
                <td class="text-center"><?= substr($row['rdate'],0,10); ?></td>
                <td class="text-center"><?= $row['hit']; ?></td>
            </tr>
            <?php } ?>
        </table>

        <div class="mt-3 d-flex justify-content-between align-items-start">
<?php
        $param = '&code='. $code;

        $rs_str = my_pagination($total, $limit, $page_limit, $page, $param);
        echo $rs_str;        
?>
        <button class="btn btn-primary" id="btn_write">글쓰기</button>

        </div>
    </div>

    <script>
        const btn_write = document.querySelector("#btn_write")
        btn_write.addEventListener("click", () => {
            self.location,href='./write.html?code=<?= $code; ?>';
        })

        const view_detail = document.querySelectorAll(".view_detail")
        view_detail.forEach( (box) => {
            box.addEventListener("click", () => {
                self.location.href='./view.html?idx=' + box.dataset.idx + '&code=' + box.dataset.code
            })
        })
    </script>
</body>
</html>